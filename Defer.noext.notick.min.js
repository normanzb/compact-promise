!function(a,b){"function"==typeof define&&define.amd?define([],function(){return a.returnExportsGlobal=b()}):"object"==typeof exports?module.exports=b():a.Defer=b()}(this,function(){var a={f:function(a){return"function"==typeof a}},b=function(a){return function(){}}(a),c=function(a){a()},d=function(a,b,c){function d(a,b,c){var d;try{d=a[u](m,b)}catch(e){f(e),c[p](e)}return d}function e(){this[t]._s=[],this[t]._f=[],this[t]._d=[]}function f(a){b.f(k.onError)&&k.onError(a)}function g(a){function b(a){i[v]=a,i[q]=!0,i[s]=!1,c(function(){for(var a=0;a<i._s.length;a++)d(i._s[a],i[v],i._d[a]);e[u](g)})}function f(a){j(f,function(a){i[s]=!1,h[u](g,a)},b,g,a)}var g=this,i=g[t];i[q]||i[r]||i[s]||(i[s]=!0,f(a))}function h(a){function b(a){i[w]=a,i[r]=!0,i[s]=!1,c(function(){for(var a=0;a<i._f.length;a++)d(i._f[a],i[w],i._d[a]);e[u](h)})}function f(a){j(function(a){i[s]=!1,g[u](h,a)},f,b,h,a)}var h=this,i=h[t];i[q]||i[r]||i[s]||(i[s]=!0,f(a))}function i(a,b){return function(e){c(function(){var c=d(a,e,b);j(b[o],b[p],b[o],b,c)})}}function j(a,c,d,e,g){var h,i;try{h=("object"==typeof g||b.f(g))&&g&&g.then}catch(j){return f(j),void c[u](e,j)}if(g===e[t])c[u](e,new TypeError(1));else if(b.f(h))try{h[u](g,function(b){i||(i=!0,a[u](e,b))},function(a){i||(i=!0,c[u](e,a))})}catch(j){if(i)return;i=!0,f(j),c[u](e,j)}else g===m?d[u](e):d[u](e,g)}function k(a){if(!(this instanceof k))return new k(a);var c=this;c[t]=a&&b.f(a.then)?a:new l(c),c[o]=function(a){g[u](c,a)},c[p]=function(a){h[u](c,a)}}function l(a){if(!(this instanceof l))return new l(a);if(this._s=[],this._f=[],this._d=[],this._defer=a&&a instanceof k?a:new k(this),this[q]=!1,this[r]=!1,this[s]=!1,this[v]=null,this[w]=null,b.f(a))try{a[u](this,this._defer[o],this._defer[p])}catch(c){f(c),this._defer[p](c)}}var m,n="prototype",o="resolve",p="reject",q="resolved",r="rejected",s="pending",t="promise",u="call",v="result",w="error";return l[n].then=function(a,c){var d,e,f=new k,g=this;return g._d.push(f),g[r]||(d=b.f(a)?i[u](g,a,f):f[o],g[q]?d[u](null,g[v]):g._s.push(d)),g[q]||(e=b.f(c)?i[u](g,c,f):f[p],g[r]?e[u](null,g[w]):g._f.push(e)),f[t]},k.Promise=l,k[o]=function(a){var b=new k;return b[o](a),b[t]},k[p]=function(a){var b=new k;return b[p](a),b[t]},a(k),k}(b,a,c);return d});